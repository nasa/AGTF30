function MWS = setup_FAN(MWS)%ScalarsMWS.FAN.s_Nc  = 2359.983186;MWS.FAN.s_Wc  = 0.768426;MWS.FAN.s_PR  = 0.769231;MWS.FAN.s_Eff = 1.036257;%Design Point DataMWS.FAN.NcDesMap = 1.0;MWS.FAN.EffDes = 0.9689;MWS.FAN.PRDes = 1.3;MWS.FAN.RlineDesMap = 2.0;%Map Definition%-----------------------------------------------------------------------------alpha1 = 0;MWS.FAN.NcVec = [ 0.5 0.6 0.7 0.8 0.9 0.95 1 1.05 1.1];MWS.FAN.RVec(1,:) = [     1.000      1.250      1.500      1.750      2.000...    2.250      2.500      2.750      3.000      3.200...    3.250      3.500 ];MWS.FAN.WcArray(1,:) = [ 1104.3380  1247.2229  1384.7280  1514.7731  1635.3656...    1742.0557  1829.9553  1866.5565  1866.5565  1866.5565...    1866.5565  1866.5565 ];MWS.FAN.WcArray(2,:) = [ 1369.0782  1519.3645  1661.7891  1793.9161  1913.4485...    2012.9872  2084.3818  2125.0225  2126.4814  2126.4814...    2126.4814  2126.4814 ];MWS.FAN.WcArray(3,:) = [ 1644.4929  1791.9211  1929.5121  2054.8865  2165.8337...    2252.1497  2302.7083  2315.6926  2315.6926  2315.6926...    2315.6926  2315.6926 ];MWS.FAN.WcArray(4,:) = [ 1919.7177  2054.9785  2179.5896  2291.5830  2389.1497...    2460.2048  2491.7344  2493.1619  2493.1619  2493.1619...    2493.1619  2493.1619 ];MWS.FAN.WcArray(5,:) = [ 2191.8401  2304.7476  2407.9941  2500.2908  2580.4556...    2636.5833  2655.9902  2655.9902  2655.9902  2655.9902...    2655.9902  2655.9902 ];MWS.FAN.WcArray(6,:) = [ 2324.3926  2422.7034  2512.5652  2593.0525  2663.3154...    2712.5415  2729.2681  2729.2681  2729.2681  2729.2681...    2729.2681  2729.2681 ];MWS.FAN.WcArray(7,:) = [ 2446.8806  2530.6360  2607.3428  2676.3726  2737.1450...    2780.9336  2798.5239  2798.8225  2798.8225  2798.8225...    2798.8225  2798.8225 ];MWS.FAN.WcArray(8,:) = [ 2564.0947  2632.0720  2694.6523  2751.4587  2802.1399...    2840.2256  2858.9136  2860.8069  2860.8069  2860.8069...    2860.8069  2860.8069 ];MWS.FAN.WcArray(9,:) = [ 2675.1184  2726.3958  2774.0383  2817.8599  2857.6853...    2889.2947  2908.2825  2914.2979  2914.2979  2914.2979...    2914.2979  2914.2979 ];MWS.FAN.EffArray(1,:) = [ 0.6585  0.7756  0.8552  0.8821  0.8316  0.6642...    0.3039  0.0010  0.0010  0.0010  0.0010  0.0010 ];MWS.FAN.EffArray(2,:) = [ 0.7145  0.8102  0.8747  0.8970  0.8603  0.7400...    0.4938  0.0386  0.0005  0.0005  0.0005  0.0005 ];MWS.FAN.EffArray(3,:) = [ 0.7692  0.8439  0.8942  0.9128  0.8896  0.8113...    0.6571  0.4108  0.1588  0.0046  0.0046  0.0046 ];MWS.FAN.EffArray(4,:) = [ 0.8178  0.8734  0.9113  0.9273  0.9159  0.8710...    0.7838  0.6910  0.5830  0.4661  0.4314  0.2151 ];MWS.FAN.EffArray(5,:) = [ 0.8588  0.8965  0.9227  0.9356  0.9327  0.9118...    0.8700  0.8384  0.7979  0.7568  0.7451  0.6766 ];MWS.FAN.EffArray(6,:) = [ 0.8749  0.9042  0.9250  0.9359  0.9357  0.9232...    0.8968  0.8791  0.8568  0.8345  0.8282  0.7920 ];MWS.FAN.EffArray(7,:) = [ 0.8857  0.9081  0.9242  0.9334  0.9350  0.9283...    0.9127  0.9016  0.8903  0.8791  0.8759  0.8579 ];MWS.FAN.EffArray(8,:) = [ 0.8926  0.9086  0.9204  0.9278  0.9302  0.9275...    0.9195  0.9118  0.9072  0.9026  0.9012  0.8936 ];MWS.FAN.EffArray(9,:) = [ 0.8945  0.9049  0.9128  0.9182  0.9207  0.9204...    0.9172  0.9109  0.9099  0.9088  0.9085  0.9063 ];MWS.FAN.PRArray(1,:) = [ 1.0760  1.0811  1.0799  1.0724  1.0588  1.0394...    1.0146  1.0000  1.0000  1.0000  1.0000  1.0000 ];MWS.FAN.PRArray(2,:) = [ 1.1171  1.1214  1.1186  1.1085  1.0914  1.0676...    1.0379  1.0024  1.0000  1.0000  1.0000  1.0000 ];MWS.FAN.PRArray(3,:) = [ 1.1703  1.1730  1.1682  1.1559  1.1363  1.1100...    1.0776  1.0414  1.0133  1.0003  1.0003  1.0003 ];MWS.FAN.PRArray(4,:) = [ 1.2381  1.2386  1.2320  1.2185  1.1981  1.1715...    1.1390  1.1094  1.0814  1.0582  1.0523  1.0222 ];MWS.FAN.PRArray(5,:) = [ 1.3234  1.3215  1.3138  1.3004  1.2814  1.2572...    1.2282  1.2039  1.1789  1.1584  1.1531  1.1265 ];MWS.FAN.PRArray(6,:) = [ 1.3734  1.3703  1.3624  1.3497  1.3323  1.3104...    1.2845  1.2628  1.2404  1.2221  1.2174  1.1937 ];MWS.FAN.PRArray(7,:) = [ 1.4288  1.4250  1.4172  1.4055  1.3900  1.3709...    1.3484  1.3284  1.3090  1.2931  1.2891  1.2686 ];MWS.FAN.PRArray(8,:) = [ 1.4898  1.4854  1.4780  1.4677  1.4545  1.4386...    1.4201  1.4022  1.3862  1.3731  1.3698  1.3530 ];MWS.FAN.PRArray(9,:) = [ 1.5553  1.5507  1.5441  1.5356  1.5251  1.5128...    1.4988  1.4831  1.4708  1.4608  1.4583  1.4455 ];% Extrapolated map values. Note, these map values are for convergence % purposes and were defined by extrapolatoin off the generic map above. NcE = [0.3 0.4];WcE = 10^3 *[ 0.5749 0.7029 0.8306 0.9565 1.0792 1.2002 1.3211 1.3496 1.3467 1.3467 1.3467 1.3467;             0.8396 0.9751 1.1077 1.2356 1.3573 1.4711 1.5755 1.6081 1.6066 1.6066 1.6066 1.6066];EffE = [0.5465 0.7064 0.8162 0.8523 0.7742 0.5126 0.0005 0.0005 0.0020 0.0020 0.0020 0.0020;             0.6025 0.7410 0.8357 0.8672 0.8029 0.5884 0.1140 0.0005 0.0015 0.0015 0.0015 0.0015];PRE = [1.0000 1.0005 1.0025 1.0002 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000;            1.0349 1.0408 1.0412 1.0363 1.0262 1.0112 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];        % Add extrapolted values to maps.MWS.FAN.NcVec    = [NcE MWS.FAN.NcVec];MWS.FAN.WcArray  = [WcE; MWS.FAN.WcArray];MWS.FAN.EffArray = [EffE; MWS.FAN.EffArray];MWS.FAN.PRArray  = [PRE; MWS.FAN.PRArray];% extrapolate Nc for SS analysisNcMax = 1.15;for i = 1:length(MWS.FAN.RVec)    WcArray_NcMax(i) = interp1(MWS.FAN.NcVec,MWS.FAN.WcArray(:,i)',NcMax,'linear','extrap');    EffArray_NcMax(i) = interp1(MWS.FAN.NcVec,MWS.FAN.EffArray(:,i)',NcMax,'linear','extrap');    PRArray_NcMax(i) = interp1(MWS.FAN.NcVec,MWS.FAN.PRArray(:,i)',NcMax,'linear','extrap');endMWS.FAN.NcVec = [MWS.FAN.NcVec NcMax];MWS.FAN.WcArray = [MWS.FAN.WcArray; WcArray_NcMax];MWS.FAN.EffArray = [MWS.FAN.EffArray; EffArray_NcMax];MWS.FAN.PRArray = [MWS.FAN.PRArray; PRArray_NcMax];% extrapolate RL for SS analysisRMin = 0.5;RMax = 4;for i = 1:length(MWS.FAN.NcVec)    WcArray_RMin(i) = interp1(MWS.FAN.RVec,MWS.FAN.WcArray(i,:),RMin,'linear','extrap');    EffArray_RMin(i) = interp1(MWS.FAN.RVec,MWS.FAN.EffArray(i,:),RMin,'linear','extrap');    PRArray_RMin(i) = interp1(MWS.FAN.RVec,MWS.FAN.PRArray(i,:),RMin,'linear','extrap');    WcArray_RMax(i) = interp1(MWS.FAN.RVec,MWS.FAN.WcArray(i,:),RMax,'linear','extrap');    EffArray_RMax(i) = interp1(MWS.FAN.RVec,MWS.FAN.EffArray(i,:),RMax,'linear','extrap');    PRArray_RMax(i) = interp1(MWS.FAN.RVec,MWS.FAN.PRArray(i,:),RMax,'linear','extrap');endMWS.FAN.RVec = [RMin MWS.FAN.RVec RMax];MWS.FAN.WcArray = [WcArray_RMin' MWS.FAN.WcArray WcArray_RMax'];MWS.FAN.EffArray = [EffArray_RMin' MWS.FAN.EffArray EffArray_RMax'];MWS.FAN.PRArray = [PRArray_RMin' MWS.FAN.PRArray PRArray_RMax'];% expand Rline = 1 to generate the stall margin vectorsPRSMVec = MWS.FAN.PRArray(:,2)'; %<--changed idx to 2 to stick with RL = 1WcSMVec = MWS.FAN.WcArray(:,2)'; %<--changed idx to 2 to stick with RL = 1WcSMmx  = max(max(MWS.FAN.WcArray));MWS.FAN.SM_WcVec = [WcSMVec, WcSMmx];PRex = PRSMVec(end) + (WcSMmx - WcSMVec(end))*(PRSMVec(end) - PRSMVec(end - 1))/(WcSMVec(end) - WcSMVec(end - 1));MWS.FAN.SM_PRVec = [PRSMVec, PRex]; 